<html>
  <head>
    <meta http-equiv="content-type" content="text/html;charset=utf8"></meta>
    <script src="../lib/jquery-1.2.js"></script>
    <script src="../lib/Ebisu.js"></script>
    <title>Field</title>
<style type="text/css">
body {
    background:black;
    color:white;
}
.fire {
    -moz-border-radius: 100px;
    width:5px;
    height:5px;
    position:absolute;
    bottom:0;
    right:0;
    background:#fff;
    color:red;
    z-index: 5;
}
#field {
    position: absolute;
    top: 0;
    left: 0;
    z-index: 10;
    overflow: hidden;
    width: 100%;
    height: 100%;
};

</style>
  </head>
  <body>
    <p>Shake your mouse randomly.</p>
    <div id="field"></div>
    <script type="text/javascript">

var gwidth = $(window).width() - 200;
var gheight = $(window).height() - 200;
var total = 100;
for(var i = 0;i < total; i++) {
    $("<div class='fire'> </div>").appendTo("#field");
}

$(document).ready(function($) {
    $("#field").mousemove(
        function(e) {
            Ebisu("mouse near").trigger(e.clientX, e.clientY);
        }
    );

    $("div.fire").each(function(i) {

        var x = Math.random() * gwidth  + 100;
        var y = Math.random() * gheight + 100;

        $(this).css({
            left: x,
            top: y
        });

        Ebisu("mouse near").to(this).attach(
            function(x, y) {
                return function(loc_x, loc_y) {
                    var diffx = Math.abs(loc_x - x);
                    var diffy = Math.abs(loc_y - y);
                    var r = Math.floor( 400 / (diffx + diffy + 4) ) ;
                    $(this).css({
                        width: r,
                        height: r,
                        'margin-top': (r / -2),
                        'margin-left': (r / -2)
                    });
                }
            }(x,y)
        );
    });

});


    </script>
  </body>
</html>
